DROP TABLE BOOKING;
DROP TABLE SEAT;
DROP TABLE PASSENGER_RISK;
DROP TABLE FLIGHT;
DROP TABLE PLANE;
DROP TABLE RISK;
DROP TABLE PASSENGER;
DROP TABLE USERS;

CREATE TABLE USERS(
"USER_ID" INT not null primary key 
GENERATED ALWAYS AS IDENTITY
(START WITH 1, INCREMENT BY 1),
"USERNAME" VARCHAR(50),
"PASSWORD" VARCHAR(64),
"AUTHENTICATED" BOOLEAN
);

CREATE TABLE PASSENGER(
"PASSENGER_ID" INT not null primary key 
GENERATED ALWAYS AS IDENTITY
(START WITH 1, INCREMENT BY 1),
"FORENAME" VARCHAR(50),
"SURNAME" VARCHAR(50),
"DOB" DATE,
"NATIONALITY" VARCHAR(50),
"RESTRICTED" BOOLEAN,
"PASSPORT_NUMBER" INT NOT NULL UNIQUE
);

CREATE TABLE RISK(
"RISK_ID" INT not null primary key 
GENERATED ALWAYS AS IDENTITY
(START WITH 1, INCREMENT BY 1),
"RISK_DESC" VARCHAR(50),
"RISK_SCORE" INT
);

CREATE TABLE PASSENGER_RISK(
"PASSENGER_RISK_ID" INT not null primary key 
GENERATED ALWAYS AS IDENTITY
(START WITH 1, INCREMENT BY 1),
"PASSENGER_ID" INT,
"RISK_ID" INT,
FOREIGN KEY (PASSENGER_ID)
REFERENCES PASSENGER(PASSENGER_ID) ON DELETE CASCADE,
FOREIGN KEY (RISK_ID)
REFERENCES RISK(RISK_ID) ON DELETE CASCADE
);

CREATE TABLE PLANE(
"PLANE_ID" INT not null primary key 
GENERATED ALWAYS AS IDENTITY
(START WITH 1, INCREMENT BY 1),
"DESIGNATION" VARCHAR(10),
"CAPACITY" INT,
"AIRLINE" VARCHAR(50),
"EQUIPMENT" VARCHAR(250)
);

CREATE TABLE FLIGHT(
"FLIGHT_ID" INT not null primary key 
GENERATED ALWAYS AS IDENTITY
(START WITH 1, INCREMENT BY 1),
"PLANE_ID" INT,
"DESTINATION" VARCHAR(50),
"ORIGIN" VARCHAR(50),
"DEPARTURE_DATE" DATE,
"DEPARTURE_TIME" TIME,
"ARRIVAL_DATE" DATE,
"ARRIVAL_TIME" TIME,
"ETA" DATE,
"MAX_RISK" INT,
FOREIGN KEY (PLANE_ID)
REFERENCES PLANE(PLANE_ID) ON DELETE CASCADE
);

CREATE TABLE SEAT(
"SEAT_ID" INT not null primary key 
GENERATED ALWAYS AS IDENTITY
(START WITH 1, INCREMENT BY 1),
"FLIGHT_ID" INT,
"SEAT_NUMBER" INT,
"SEAT_TAKEN" BOOLEAN,
FOREIGN KEY (FLIGHT_ID)
REFERENCES FLIGHT(FLIGHT_ID) ON DELETE CASCADE
);

CREATE TABLE BOOKING(
"BOOKING_ID" INT not null primary key 
GENERATED ALWAYS AS IDENTITY
(START WITH 1, INCREMENT BY 1),
"PASSENGER_ID" INT,
"SEAT_ID" INT,
FOREIGN KEY (PASSENGER_ID)
REFERENCES PASSENGER(PASSENGER_ID) ON DELETE CASCADE,
FOREIGN KEY (SEAT_ID)
REFERENCES SEAT(SEAT_ID)ON DELETE CASCADE
);